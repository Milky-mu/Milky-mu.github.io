<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>木宝宝&林宝宝的小窝</title>
  <meta name="description" content="情侣纪念网站：视差大图、交错时间轴、深浅色主题、回到顶部、相伴天数与周年倒计时" />
  <style>
    :root{
      --bg:#fffaf7; --text:#222; --muted:#6b6b6b; --primary:#ff6b81; --card:#fff; --shadow:0 10px 30px rgba(0,0,0,.08)
    }
    :root.dark{ --bg:#0e0f12; --text:#eaeaea; --muted:#9aa0a6; --card:#14161a; --primary:#ff7a90 }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--text);font-family:Inter, system-ui, -apple-system, "PingFang SC","Microsoft YaHei", sans-serif;line-height:1.7}
    img{max-width:100%;display:block}
    a{text-decoration:none;color:inherit}
    .container{max-width:1100px;margin:0 auto;padding:0 20px}
    .section{padding:80px 0}
    h1,h2,h3{margin:0 0 12px}
    h2{font-size:30px}
    .muted{color:var(--muted)}

    /* 顶部导航 */
    .nav{position:sticky;top:0;background:rgba(255,255,255,.6);backdrop-filter:blur(10px);z-index:999;border-bottom:1px solid rgba(0,0,0,.06)}
    :root.dark .nav{background:rgba(20,22,26,.6);border-color:rgba(255,255,255,.06)}
    .nav-inner{display:flex;align-items:center;justify-content:space-between;max-width:1100px;margin:0 auto;padding:10px 20px}
    .logo{font-weight:800;font-size:18px}
    .logo span{color:var(--primary)}
    .nav nav a{margin:0 10px;opacity:.85}
    .nav nav a:hover{opacity:1}
    .theme{margin-left:8px;border:1px solid rgba(0,0,0,.1);background:transparent;border-radius:8px;padding:6px 10px;cursor:pointer}

    /* 视差区域 */
    .parallax{position:relative;background:#ddd;background-size:cover;background-position:center;background-attachment:fixed}
    .hero{
      min-height:72vh;display:grid;place-items:center;text-align:center;
      background-image:
        linear-gradient(135deg, rgba(255,255,255,.08), rgba(255,255,255,.08)),
        url('assets/img/bg1.jpg');
    }
    .hero-inner{padding:90px 20px}
    .hero h1{font-size:42px;margin-bottom:8px}
    .btn{display:inline-block;margin-top:16px;padding:10px 18px;border-radius:999px;background:var(--primary);color:#fff;border:none;cursor:pointer;box-shadow:var(--shadow)}

    /* 双列故事 */
    .two-col{display:grid;grid-template-columns:1.2fr .8fr;gap:28px;align-items:center}
    .cards{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-top:14px}
    .card{background:var(--card);border-radius:14px;padding:16px;box-shadow:var(--shadow)}
    .side-photo{border-radius:18px;overflow:hidden;box-shadow:var(--shadow)}

    /* 数字条 */
    .strip{background:linear-gradient(90deg, rgba(255,107,129,.12), transparent)}
    .stats{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;padding:18px 0}
    .stat{background:var(--card);border-radius:14px;box-shadow:var(--shadow);padding:18px;text-align:center}
    .stat span{display:block;font-size:28px;font-weight:800}

    /* 时间轴（左右交错） */
    .timeline{list-style:none;padding:0;margin:24px 0;position:relative}
    .timeline::before{content:'';position:absolute;left:50%;top:0;bottom:0;width:2px;background:rgba(0,0,0,.1)}
    .tl-item{position:relative;padding:10px 40px;width:50%}
    .tl-item:nth-child(odd){left:0;text-align:right}
    .tl-item:nth-child(even){left:50%}
    .tl-content{background:var(--card);border-radius:14px;box-shadow:var(--shadow);display:inline-block;padding:12px 16px}
    .tl-content time{color:var(--muted);font-size:12px}

    /* 中段视差（调淡遮罩） */
    .mid{
      min-height:42vh;display:grid;place-items:center;
      background-image:
        linear-gradient(135deg, rgba(255,255,255,.06), rgba(255,255,255,.06)),
        url('assets/img/bg3.jpg');
      background-size:cover;background-position:center;background-attachment:fixed
    }
    .quote blockquote{font-size:28px;text-align:center;opacity:.95}

    /* 相册 Masonry（纯图片，不可点击） */
    .masonry{column-count:4;column-gap:14px}
    .item{break-inside:avoid;margin-bottom:14px;display:block;border-radius:12px;overflow:hidden;box-shadow:var(--shadow);cursor:default}
    .item img{width:100%;height:auto;display:block;transition:transform .3s}
    .item:hover img{transform:scale(1.02)}

    /* 保险：彻底禁用/隐藏任何可能的灯罩与覆盖层 */
    .lightbox, #lightbox, .overlay, .backdrop { display:none !important; }
    #gallery .item{ pointer-events:none; }
    .hero video{ pointer-events:none; }
    .parallax::before,.parallax::after{ pointer-events:none; }

    .footer{padding:40px 0;text-align:center;border-top:1px solid rgba(0,0,0,.06)}
    #toTop{position:fixed;right:16px;bottom:16px;border:none;background:var(--primary);color:#fff;border-radius:50%;width:44px;height:44px;cursor:pointer;box-shadow:var(--shadow);display:none}

    /* 动画 */
    .fade{opacity:0;transform:translateY(10px);transition:all .6s ease}
    .fade.show{opacity:1;transform:none}
    .delay{transition-delay:.15s}
    .delay2{transition-delay:.3s}

    /* 让视频样式与图片协调 */
    .secret-content video{width:100%;max-width:720px;border-radius:16px;box-shadow:var(--shadow)}

    @media (max-width:900px){
      .two-col{grid-template-columns:1fr}
      .masonry{column-count:2}
      .timeline::before{left:8px}
      .tl-item,.tl-item:nth-child(even){left:0;width:100%;text-align:left;padding-left:28px}
    }
  </style>
</head>
<body>
  <header class="nav">
    <div class="nav-inner">
      <a href="#top" class="logo">US<span>·Pro</span></a>
      <nav>
        <a href="#story">故事</a>
        <a href="#stats">天数</a>
        <a href="#timeline">时间轴</a>
        <a href="#gallery">相册</a>
        <a href="#secret">彩蛋</a>
        <button id="themeToggle" class="theme" title="深浅色切换">🌓</button>
      </nav>
    </div>
  </header>

  <section id="top" class="hero parallax">
    <div class="hero-inner">
      <h1 class="fade">恋情如递归，终止条件是你。</h1>
      <p class="fade delay">Since <span id="start-date-label">2022-09-10</span></p>
      <a href="#gallery" class="btn fade delay2">去看相册</a>
    </div>
  </section>

  <section id="story" class="container section two-col">
    <div>
      <h2>我们的故事</h2>
      <p>从 <strong>2022-07-21</strong> 相识，到 <strong>2022-09-10</strong> 在一起。</p>
      <div class="cards">
        <div class="card"><h3>Chapter 1</h3><p>第一次见面，像预谋很久的偶遇。</p></div>
        <div class="card"><h3>Chapter 2</h3><p>正式在一起：第 1 天，也是第 ∞ 天的开始。</p></div>
        <div class="card"><h3>Chapter 3</h3><p>要一直一直在一起。</p></div>
      </div>
    </div>
    <figure class="side-photo">
      <img src="assets/img/bg2.jpg" alt="我们的照片" onerror="this.style.display='none'"/>
    </figure>
  </section>

  <section id="stats" class="strip">
    <div class="container stats">
      <div class="stat"><span id="days-since">0</span><label>在一起超多天了！</label></div>
      <div class="stat"><span id="cd-days">0</span><label>距重逢的时间</label></div>
      <div class="stat"><span id="years">0</span><label>已走过的时光</label></div>
    </div>
  </section>

  <section id="timeline" class="container section">
    <h2>时间轴</h2>
    <ul class="timeline">
      <li class="tl-item"><div class="tl-content"><time>2022-07-21</time><h3>第一次见面</h3><p>明明是不开心的一天，但是认识了林宝宝，所以一切都可以。</p></div></li>
      <li class="tl-item"><div class="tl-content"><time>2022-09-10</time><h3>素男朋友了</h3><p>以后就是两个人的小故事。</p></div></li>
      <li class="tl-item"><div class="tl-content"><time>2022-10-03</time><h3>第一次一起出门——广州！</h3><p>一起骑自行车，开心。</p></div></li>
      <li class="tl-item"><div class="tl-content"><time>2023-08-21</time><h3>林宝宝出国啦</h3><p>一直到今天的异地，我们都超棒的。</p></div></li>
    </ul>
  </section>

  <section class="parallax mid"></section>

  <section id="gallery" class="container section">
    <h2>时间轴相册！</h2>
    <div class="masonry">
      <div class="item"><img src="assets/img/pic1.jpg" alt="pic1" onerror="this.parentElement.style.display='none'"></div>
      <div class="item"><img src="assets/img/pic2.jpg" alt="pic2" onerror="this.parentElement.style.display='none'"></div>
      <div class="item"><img src="assets/img/pic3.jpg" alt="pic3" onerror="this.parentElement.style.display='none'"></div>
      <div class="item"><img src="assets/img/pic4.jpg" alt="pic4" onerror="this.parentElement.style.display='none'"></div>
    </div>
  </section>

  <!-- 这里开始：小彩蛋（解锁后播放视频） -->
  <section id="secret" class="container section">
    <h2>小彩蛋</h2>
    <p class="muted">输入暗号解锁（默认 1096）</p>
    <div class="secret-box">
      <input id="secret-input" placeholder="输入暗号">
      <button class="btn" id="secret-btn">解锁</button>
    </div>

    <div id="secret-content" class="secret-content" hidden>
      <video id="secret-video"
             controls
             preload="metadata"
             playsinline
             poster="assets/img/secret_poster.jpg"
             style="width:100%;max-width:720px;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.08);">
        <source src="assets/video/secret.mp4" type="video/mp4">
        你的浏览器不支持视频标签。
      </video>
      <p class="muted" id="secret-tip" style="margin-top:8px;">解锁成功！如果没有自动播放，点一下播放键哦～</p>
    </div>
  </section>
  <!-- 小彩蛋结束 -->

  <footer class="footer">
    <div class="container">
      <p>© <span id="year"></span> For Us · GitHub Pages</p>
    </div>
  </footer>

  <button id="toTop" title="返回顶部">↑</button>

  <script>
    const CONFIG = { startDate: '2022-09-10', anniversaryBase: '09-10', secretCode: '1096' };

    function daysBetween(a,b){ const d1=new Date(a+'T00:00:00'); const d2=new Date(b+'T00:00:00'); return Math.floor((d2-d1)/(1000*60*60*24)); }

    function updateStats(){
      const today = new Date(); const todayStr=today.toISOString().slice(0,10);
      document.getElementById('start-date-label').textContent = CONFIG.startDate;
      document.getElementById('year').textContent = today.getFullYear();
      const days = daysBetween(CONFIG.startDate, todayStr) + 1;
      document.getElementById('days-since').textContent = days;
      document.getElementById('years').textContent = (days/365).toFixed(2);
      const y = today.getFullYear(); const tgt = new Date(`${y}-${CONFIG.anniversaryBase}T00:00:00`);
      const target = (tgt >= today) ? tgt : new Date(`${y+1}-${CONFIG.anniversaryBase}T00:00:00`);
      const cd = Math.max(0, daysBetween(todayStr, target.toISOString().slice(0,10)));
      document.getElementById('cd-days').textContent = cd;
    }

    // ✅ 新版：解锁后显示并播放视频
    function initSecret(){
      const btn = document.getElementById('secret-btn');
      const input = document.getElementById('secret-input');
      const box = document.getElementById('secret-content');

      btn.addEventListener('click', async ()=>{
        const val = (input.value || '').trim();
        if (val !== CONFIG.secretCode) {
          alert('暗号不对，再试试 ;)');
          return;
        }

        // 显示视频区并尝试静音自动播放
        box.hidden = false;
        const v = document.getElementById('secret-video');
        if (v) {
          try {
            v.currentTime = 0;
            v.muted = true;       // 静音更容易自动播放（移动端策略）
            await v.play();
            const tip = document.getElementById('secret-tip');
            if (tip) tip.textContent = '已自动播放（静音）。点播放器取消静音即可听到声音～';
          } catch (e) {
            console.warn('autoplay blocked:', e);
          }

          // 允许点击视频切换静音
          v.addEventListener('click', ()=>{ v.muted = !v.muted; });
        }

        // 平滑滚动到视频
        box.scrollIntoView({behavior:'smooth', block:'center'});
      });
    }

    function initScroll(){
      const toTop=document.getElementById('toTop');
      window.addEventListener('scroll',()=>{ toTop.style.display = window.scrollY>200 ? 'block':'none'; });
      toTop.onclick=()=>window.scrollTo({top:0,behavior:'smooth'});
      const obs=new IntersectionObserver((es)=>{ es.forEach(en=>{ if(en.isIntersecting) en.target.classList.add('show'); }); },{threshold:.15});
      document.querySelectorAll('.fade').forEach(el=>obs.observe(el));
    }

    function initTheme(){
      const key='us-theme'; const btn=document.getElementById('themeToggle');
      const set=t=>{ document.documentElement.classList.toggle('dark', t==='dark'); localStorage.setItem(key,t); };
      set(localStorage.getItem(key)||'light');
      btn.onclick=()=>{ const t=document.documentElement.classList.contains('dark')?'light':'dark'; set(t); };
    }

    // 急救：移除任何可能的遮罩/覆盖层，恢复点击
    document.addEventListener('DOMContentLoaded', () => {
      ['#lightbox','.lightbox','.overlay','.backdrop'].forEach(sel=>{
        document.querySelectorAll(sel).forEach(el=>el.remove());
      });
      Array.from(document.body.children).forEach(el=>{
        const r=el.getBoundingClientRect(); const z=+getComputedStyle(el).zIndex||0;
        if((el.style.position==='fixed'||getComputedStyle(el).position==='fixed') &&
           r.width>=innerWidth*0.98 && r.height>=innerHeight*0.98 && z>=10){
          el.remove();
        }
      });
    });

    document.addEventListener('DOMContentLoaded',()=>{
      updateStats();
      initSecret();
      initScroll();
      initTheme();
    });
  </script>
</body>
</html>
